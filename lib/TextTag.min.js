TextTag={on:function(e){if("string"!=typeof e)return console.error(`TextTag.on(id) : id should be a string instead of "${typeof e}"`),null;if(null!=TextTag._domElements[e])return console.warn(`${e} is already used`),TextTag._domElements[e];let t={addTag:function(e,t){return null!=this._tags[e]?(console.error("Tag already exist on this node"),null):(this._tags[e]=t,this)},_setInfoPos:function(){var e=getCursorXY(this.DOM,this.DOM.selectionEnd);this._infoDOM.style.display="",this._infoDOM.style.top=`${e.y-184}px`,this._infoDOM.style.left=`${e.x-10}px`},_showResult:function(e){0==e.length&&this._hideResult();let t="<div>";for(let n of e)t+=`<div>${n}</div>`;this._infoDOM.innerHTML=t+"</div>"},_hideResult:function(){this._infoDOM.style="display:none;",this._tagEntered="",this._infoDOM.innerHTML=""},_tagEntered:"",_tags:[]};if(t.DOM=document.getElementById(e),null==t.DOM)return console.error(`No element named : ${e}`),null;switch(t.DOM.tagName.toUpperCase()){case"TEXTAREA":break;case"INPUT":if("text"!=t.DOM.type)return console.error("Not supported input type"),null;break;default:return console.error("Not supported tag type"),null}let n=t.DOM.outerHTML;return t.DOM.outerHTML=`<div class="TT_parent"><div class="TT_input">${n}</div><div class="TT_tooltip" style="display:none;"></div></div>`,t.DOM=document.getElementById(e),t._infoDOM=t.DOM.parentElement.parentElement.children[1],t.DOM.onkeypress=function(e){if(" "==e.key&&""!=this.TT._tagEntered&&(this.TT._tagEntered="",this.TT._hideResult()),""!=this.TT._tagEntered){let t=RegExp(this.TT._tagEntered+"[A-Za-z0-9]*$").exec(this.value);if(null==t){this.TT._tagEntered="",this.TT._hideResult();return}let n=this;this.TT._tags[this.TT._tagEntered](t[0].replace(this.TT._tagEntered,"")+e.key,function(e){n.TT._showResult(e)});return}if(null==this.TT._tags[e.key])return;this.TT._tagEntered=e.key;let s=this;this.TT._tags[this.TT._tagEntered]("",function(e){s.TT._showResult(e)}),this.TT._setInfoPos()},t.DOM.onkeydown=function(e){switch(e.key){case"Enter":e.key=" ",t.DOM.onkeypress(e);break;case"Backspace":e.key="",t.DOM.onkeypress(e);break;case"Escape":this.TT._hideResult()}},TextTag._domElements[e]=t,t.DOM.TT=t,t},get:function(e){return"string"!=typeof e?(console.error(`TextTag.on(id) : id should be a string instead of "${typeof e}"`),null):null==TextTag._domElements[e]?(console.error(`"${e}" comportment doesn't exist
Create a comportment with .on() function`),null):TextTag._domElements[e]},_domElements:[]};const getCursorXY=(e,t)=>{let{offsetLeft:n,offsetTop:s}=e,i=document.createElement("div"),r=getComputedStyle(e);for(let o of r)i.style[o]=r[o];let l="INPUT"===e.tagName?e.value.replace(/ /g,"."):e.value,a=l.substr(0,t);i.textContent=a,"TEXTAREA"===e.tagName&&(i.style.height="auto"),"INPUT"===e.tagName&&(i.style.width="auto");let d=document.createElement("span");d.textContent=l.substr(t)||".",i.appendChild(d),document.body.appendChild(i);let{offsetLeft:u,offsetTop:T}=d;return document.body.removeChild(i),{x:n+u,y:s+T}};
